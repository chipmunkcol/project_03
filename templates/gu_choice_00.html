<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ê³µì› ì„ íƒ í˜ì´ì§€</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;300;400;500;600;700;900&display=swap"
          rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--    jQuery-ì¿ í‚¤ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Jua&family=Nanum+Pen+Script&family=Noto+Serif+KR:wght@200;300;400;500;600;700;900&display=swap"
          rel="stylesheet">

    <style>
        * {
            font-family: 'Gowun Dodum', sans-serif;
        }

        .wrap {
            background-image: url("https://images.unsplash.com/photo-1613931372190-b067a12f73b6?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NTl8fHdhbGtpbmd8ZW58MHx8MHx8&auto=format&fit=crop&w=800&q=60");
            background-size: cover;
            background-position: center;
        }

        .buttons {
            background-color: rgba(255, 255, 255, 0.5);
            margin: 20px auto 0px auto;
            border: 1px solid gray;
            border-radius: 10px;
            max-width: 870px;
            width: 95%;
            max-height: 400px;
            box-sizing: border-box;
        }

        .buttons > button {
            margin: 10px 10px 10px 10px;
        }

        .park_list {
            background-color: rgba(255, 255, 255, 0.8);
            margin: 20px auto 0px auto;
            padding: 10px;
            border: 1px solid gray;
            border-radius: 10px;
            max-width: 870px;
            width: 95%;
            box-sizing: border-box;
        }

        .parkName {
            margin: 30px auto 30px auto;
        }

        .closeButton {
            margin-top: 20px;
            background-color: transparent;
            border-radius: 5px;
            border: 1px solid;
        }

        .seoulImg {
            max-width: 500px;
            width: 90%;
            max-height: 100%;
            height: 90%;
            background-image: url("https://cdn.crowdpic.net/detail-thumb/thumb_d_EA698713FB43A572F10161572888A70A.png");
            background-size: cover;
            background-position: center;
        }

        .mapBg {
            max-width: 600px;
            width: 60%;
            height: 500px;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;

            margin: 20px auto 0px auto;
            border-radius: 20px;
        }

        .logoutButton {
            background-color: rgba(255, 255, 255, 0.6);
            margin-top: 20px;
            margin-right: 20px;
            border-radius: 5px;
        }
        .btnDiv{
            height: 50px;
            width: 100%
        }

        .title {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
    </style>
    <script>
        $(document).ready(function () {
            $.ajax({
                type: "GET",
                url: "http://openapi.seoul.go.kr:8088/6a4c6750656c6a63363572677a7573/json/SearchParkInfoService/1/132",
                data: {},
                success: function (response) {
                    let list = (response['SearchParkInfoService']['row']); //ê°€ì ¸ì˜¨ apië¥¼ ë°°ì—´ë¡œ ë§Œë“ ë‹¤.
                    let arr = []; //ë¹ˆ ë°°ì—´ ìƒì„±
                    let parkList = new Array(list.length); //ê°€ì ¸ì˜¨ ë¦¬ìŠ¤íŠ¸ì˜ í¬ê¸°ì™€ ê°™ì€ ë°°ì—´ìƒì„±
                    for (let i = 0; i < list.length; i++) { //í¬ë¬¸ì„ ëŒë©´ì„œ êµ¬ì´ë¦„,ê³µì›ì£¼ì†Œ,ê³µì›ì´ë¦„,ì„¤ëª…ì„ ì¶”ì¶œí•˜ê³  parkListì—ëŠ” 4ê°œë¥¼ ë‹¤ ë„£ì–´ì£¼ê³  arrëŠ” êµ¬ì˜ì´ë¦„ë§Œ ë„£ì–´ì¤€ë‹¤.
                        let gu_name = list[i]['P_ZONE'];
                        let park_addr = list[i]['P_ADDR'];
                        let park_name = (list[i]['P_PARK']);
                        let desc = (list[i]['P_LIST_CONTENT']);
                        parkList[i] = [gu_name, park_addr, park_name, desc]
                        arr.push(gu_name)
                    }
                    console.log(parkList)//ëª¨ë“  ê³µì›ì— ëŒ€í•œ ë‚´ìš©ì´ ì˜ì°íˆëŠ”ì§€ ë¡œê·¸ë¡œ ì°ì–´ë´„.
                    let uniqueSet = new Set(arr);
                    let uniqueArr = [...new Set(arr)]; // ... : ìŠ¤í”„ë ˆë“œ ì—°ì‚°ì
                    uniqueArr.pop(); //arrì— ë“¤ì–´ìˆëŠ” êµ¬ì˜ ì´ë¦„ë“¤ì˜ ì¤‘ë³µëœ ê°’ë“¤ì€ ì—†ì•¤ë‹¤.
                    for (let i = 0; i < uniqueArr.length; i++) { //êµ¬ì˜ ì´ë¦„ì´ ë“¤ì€ ë¦¬ìŠ¤íŠ¸ë¥¼ ëŒë©´ì„œ ë²„íŠ¼htmlì„ ë§Œë“¤ì–´ì¤€ë‹¤.
                        let button_html = `<button onclick="openList(${i})" type="button" class="btn btn-success">${uniqueArr[i]}</button>`;
                        $('#buttons').append(button_html);
                        let parkList_html = `
                        <div id="${i}">
                            <h2 id="gu_name">${uniqueArr[i]}</h2>
                            <div id="parkName${i}"></div>
                            <button onclick="closeList(${i})" type="button" class="btn btn-dark">ë‹«ê¸°</button>
                        </div>`; //êµ¬ì— ëŒ€í•œê±¸ ë§Œë“¤ì–´ì¤€ë‹¤.
                        $('#park_list').append(parkList_html);
                        $('#' + i).hide(); //ëª¨ë“  ê³µì›ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤.
                        for (let j = 0; j < parkList.length; j++) {
                            if (uniqueArr[i] == parkList[j][0]) {
                                let park_name = parkList[j][2];
                                let park_addr = parkList[j][1];
                                let gu_name = parkList[j][0];
                                let park_desc = parkList[j][3];
                                let temp_html = `<div class=parkName>
                                <h6 class="nameAddr">${park_name} (${park_addr})</h6>
                                <button onclick=sendData('${park_name}') type="button" class="btn btn-outline-dark">ìƒì„¸ë³´ê¸°</button>
                                <hr>
                                <div>`
                                $('#parkName' + i).append(temp_html);
                            }
                        }
                    }
                }
            })
        });

        function sendData(park_name) {
            localStorage.setItem('park_name', park_name);
            window.location.href = "/review/" + park_name;
        }

        function openList(number) {
            $('#' + number).show();
            for (let i = 0; i <= 26; i++) {
                if (number == i) {
                    continue;
                }
                $('#' + i).hide();
            }
        }

        function closeList(number) {
            $('#' + number).hide()
        }

        function sing_out() {
            $.removeCookie('mytoken', {path: '/'});
            alert('ë¡œê·¸ì•„ì›ƒ!')
            window.location.href = '/'
        }
    </script>
</head>

<body class="wrap">
    <div class="btnDiv">
        <button style="float:right" class="logoutButton" onclick="sing_out()">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
    <div class="title">
        <h1 style="margin-top:20px; color: #F0FFFF">ğŸš¶ ê±¸ì–´, ê°œë°œìì•¼ &#128099;</h1>
    </div>

    <div class="mapBg">
        <div class="seoulImg">
        </div>
    </div>

    <div class="park_list" id="park_list">
    </div>

    <div class="buttons" id="buttons">
    </div>
</body>

</html>